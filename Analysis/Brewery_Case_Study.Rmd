---
title: "Beer type by region"
author: "Matt Pavlovich & Steven Millett"
date: "October 4, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



## Beer type by region Business growth: Case Study

</br>
This is a systematic study of the most popular types of beers and where they are popular. We obtained some demographic data from Beer Advocate with brewery information by State and the most popular beers and their breweries, where we will make the case of what popular beer types that are missing in a given region and how you can invest wisely given your local region. 




These are all of the beers that I have drunk and where I drunked them 
<!-- Load Data from the Data directory -->
```{r loadData , echo=TRUE}
breweryData <- read.csv("Data/Breweries.csv",header = TRUE)
beerData <- read.csv("Data/Beers.csv", header = TRUE)
head(breweryData)
head(beerData)
```

<!-- This creates a new table which has the State and the number of brewies per state -->
```{r frequencyOfBreweries , echo=TRUE}

frequencyOfBrewies <- as.data.frame(table(breweryData$State))
colnames(frequencyOfBrewies) <- c("State","Freq")

```

<!-- This  joins the data on the Brewery ID attribute -->
```{r mergeBeerAndBreweryData , echo=TRUE}

populationData <- merge(beerData, breweryData,by.x="Brewery_id", by.y="Brew_ID")
head(populationData)

```
</br>

##### Update column names after merge
```{r}
names(populationData) <- c("Brewery_ID", "Beer Name", "Beer_ID", "ABV", "IBU", "Style", "Ounces", "Brewery Name", "City", "State")
str(populationData)
```
</br>

## Number of NA's in each column
```{r}
colSums(is.na(populationData))
```

</br>

## Alcohol Content and International Bitterness Unit by state
```{r, fig.width=10,fig.height=11}
fetchMean <- function(column) {
  mean(column, na.rm = T)
}

plotBarChart <- function(data, xColumn, yColumn, main, xLab, yLab) {
  ggplot(data=data, aes(xColumn, yColumn, fill = ifelse(yColumn == max(yColumn), 1, 0)) ) + geom_bar(stat = "identity") + coord_flip() + labs(title= main, x=xLab, y=yLab) + theme(legend.position="none")
}

populationData.by.state <- split(populationData, f = populationData$State, drop = T)

mean.IBU.by.state <- sapply(populationData.by.state, function(x) { fetchMean(x$IBU) })
mean.ABV.by.state <- sapply(populationData.by.state, function(x) { fetchMean(x$ABV) })

states <- sort(as.character(unique(populationData$State)))

# convert states and abv means to data frame
df.abv.by.state <- data.frame(mean.ABV.by.state)
df.abv.by.state$State = states
row.names(df.abv.by.state) <- NULL
df.abv.by.state <- df.abv.by.state[c(2, 1)]
names(df.abv.by.state) <- c("State", "ABV")
df.abv.by.state$ABV[is.na(df.abv.by.state$ABV)] <- 0

# convert states and ibu means to data frame
df.ibu.by.state <- data.frame(mean.IBU.by.state)
df.ibu.by.state$State = states
row.names(df.ibu.by.state) <- NULL
df.ibu.by.state <- df.ibu.by.state[c(2, 1)]
names(df.ibu.by.state) <- c("State", "IBU")
df.ibu.by.state$IBU[is.na(df.ibu.by.state$IBU)] <- 0

library(ggplot2)

plotBarChart(data = df.abv.by.state, xColumn = df.abv.by.state$State, yColumn = df.abv.by.state$ABV, main = "Alcohol By Volume by State\n", xLab = "State", yLab = "ABV")

plotBarChart(data = df.ibu.by.state, xColumn = df.ibu.by.state$State, yColumn = df.ibu.by.state$IBU, main = "International Bitterness Unit by State\n", xLab = "State", yLab = "IBU")
```
